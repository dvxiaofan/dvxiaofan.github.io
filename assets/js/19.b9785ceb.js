(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{171:function(e,t,a){"use strict";a.r(t);var s=a(0),r=Object(s.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"使用filesaver-js把base64数据转成表格并下载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用filesaver-js把base64数据转成表格并下载","aria-hidden":"true"}},[e._v("#")]),e._v(" 使用FileSaver.js把base64数据转成表格并下载")]),e._v(" "),a("blockquote",[a("p",[e._v("最近公司项目有一个需求， 是按行业要求的一个“怪异”格式表格下载下来，后端通过表格设计器搞了一个模板，然后填充数据， 前端通过接口获取到返回的base64格式的数据，转成表格提供下载，就用到了这个FileSaver.js")])]),e._v(" "),a("h3",{attrs:{id:"引入-filesaver-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#引入-filesaver-js","aria-hidden":"true"}},[e._v("#")]),e._v(" 引入 "),a("code",[e._v("FileSaver.js")])]),e._v(" "),a("p",[e._v("在HTML页面引入， 我采用的是cdn引入")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('<script src="http://cdn.staticfile.org/FileSaver.js/1.3.8/FileSaver.min.js"><\/script>\n')])])]),a("h3",{attrs:{id:"把base64-转成能下载的文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#把base64-转成能下载的文件","aria-hidden":"true"}},[e._v("#")]),e._v(" 把base64 转成能下载的文件")]),e._v(" "),a("p",[e._v("先实现这个转换方法")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("function b64toFile(b64Data, filename, contentType) {\n    let sliceSize = 512;\n    let byteCharacters = atob(b64Data);\n    let byteArrays = [];\n\n    for (let offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n        let slice = byteCharacters.slice(offset, offset + sliceSize);\n        let byteNumbers = new Array(slice.length);\n\n        for (let i = 0; i < slice.length; i++) {\n            byteNumbers[i] = slice.charCodeAt(i);\n        }\n        let byteArray = new Uint8Array(byteNumbers);\n        byteArrays.push(byteArray);\n    }\n\n    let file = new File(byteArrays, filename, {type: contentType});\n    return file;\n}\n")])])]),a("h3",{attrs:{id:"转换并下载表格数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#转换并下载表格数据","aria-hidden":"true"}},[e._v("#")]),e._v(" 转换并下载表格数据")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// base64Data 是服务器获取到的数据\nlet file = b64toFile(base64Data, 'test', 'application/vnd.ms-excel;charset=utf-8');\n\n// 利用FileSaver.js 下载文件为Excel文件\nsaveAs(file, \"fileName.xls\");\n")])])]),a("p",[e._v("是不是so easy 呢？")])])}],!1,null,null,null);t.default=r.exports}}]);